{"version":3,"sources":["C:\\Users\\Dass\\Desktop\\Master1_YNOV\\DevLogiciel\\biblio\\src\\main\\webapp\\app\\admin\\audits\\audits.component.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BY;;;;;;;;;;;;;;;;;;;;AA9BZ,MAAA,MAAA;AAAA;AAAA,0BAAA,OAAA,CAAA,eAAA,CAAA,CAAA;AAEA,MAAA,QAAA;AAAA;AAAA,0BAAA,OAAA,CAAA,iBAAA,CAAA,CAAA;AACA,MAAA,QAAA;AAAA;AAAA,0BAAA,OAAA,CAAA,iBAAA,CAAA,CAAA;AACA,MAAA,MAAA;AAAA;AAAA,0BAAA,OAAA,CAAA,MAAA,CAAA,CAAA;AAEA,MAAA,sBAAA;AAAA;AAAA,0BAAA,OAAA,CAAA,2CAAA,CAAA,CAAA;AAEA,MAAA,gBAAA;AAAA;AAAA,0BAAA,OAAA,CAAA,kBAAA,CAAA,CAAA;;;;AAMA,IAAa,eAAe,GAA5B,MAAa,eAAb,CAA4B;AAY1B,EAAA,WAAA,CACU,aADV,EAEU,cAFV,EAGU,QAHV,EAIU,MAJV,EAIwB;AAAA;AAAA;AAAA;AAHd,SAAA,aAAA,GAAA,aAAA;;AAGc;AAAA;AAFd,SAAA,cAAA,GAAA,cAAA;;AAEc;AAAA;AADd,SAAA,QAAA,GAAA,QAAA;;AACc;AAAA;AAAd,SAAA,MAAA,GAAA,MAAA;;AAAc;AAAA;AAdxB,SAAA,QAAA,GAAW,EAAX;;AAcwB;AAAA;AAbxB,SAAA,YAAA,GAAe,sBAAA,CAAA,cAAf;;AAawB;AAAA;AATxB,SAAA,MAAA,GAAS,EAAT;;AASwB;AAAA;AARxB,SAAA,UAAA,GAAa,CAAb;;AAQwB;AAAA;AANhB,SAAA,UAAA,GAAa,YAAb;AAOJ;;AAEJ,EAAA,QAAQ,GAAA;AAAA;AAAA;AAAA;AACN,SAAK,MAAL,GAAc,KAAK,KAAL,EAAd;;AADM;AAAA;AAEN,SAAK,QAAL,GAAgB,KAAK,aAAL,EAAhB;;AAFM;AAAA;AAGN,SAAK,gBAAL;AACD;;AAED,EAAA,OAAO,GAAA;AAAA;AAAA;AAAA;AACL,WAAO;AAAA;AAAA,wCAAK,QAAL,KAAkB,EAAlB;AAAA;AAAA,mCAAwB,KAAK,MAAL,KAAgB,EAAxC;AAAP;AACD;;AAED,EAAA,UAAU,GAAA;AAAA;AAAA;AAAA;;AACR,QAAI,KAAK,OAAL,EAAJ,EAAoB;AAAA;AAAA;AAAA;AAClB,WAAK,MAAL,CAAY,QAAZ,CAAqB,CAAC,eAAD,CAArB,EAAwC;AACtC,QAAA,WAAW,EAAE;AACX,UAAA,IAAI,EAAE,KAAK,IADA;AAEX,UAAA,IAAI,EAAE,KAAK,SAAL,GAAiB,GAAjB,IAAwB,KAAK,SAAL;AAAA;AAAA,uCAAiB,KAAjB;AAAA;AAAA,uCAAyB,MAAzB,CAAxB,CAFK;AAGX,UAAA,IAAI,EAAE,KAAK,QAHA;AAIX,UAAA,EAAE,EAAE,KAAK;AAJE;AADyB,OAAxC;AAQD,KATD;AAAA;AAAA;AAAA;AAAA;AAUD;;AAEO,EAAA,aAAa,GAAA;AAAA;AAAA;AACnB,QAAI,IAAI;AAAA;AAAA,+BAAG,IAAI,IAAJ,EAAH,CAAR;;AADmB;AAAA;;AAEnB,QAAI,IAAI,CAAC,QAAL,OAAoB,CAAxB,EAA2B;AAAA;AAAA;AAAA;AACzB,MAAA,IAAI,GAAG,IAAI,IAAJ,CAAS,IAAI,CAAC,WAAL,KAAqB,CAA9B,EAAiC,EAAjC,EAAqC,IAAI,CAAC,OAAL,EAArC,CAAP;AACD,KAFD,MAEO;AAAA;AAAA;AAAA;AACL,MAAA,IAAI,GAAG,IAAI,IAAJ,CAAS,IAAI,CAAC,WAAL,EAAT,EAA6B,IAAI,CAAC,QAAL,KAAkB,CAA/C,EAAkD,IAAI,CAAC,OAAL,EAAlD,CAAP;AACD;;AANkB;AAAA;AAOnB,WAAO,KAAK,QAAL,CAAc,SAAd,CAAwB,IAAxB,EAA8B,KAAK,UAAnC,CAAP;AACD;;AAEO,EAAA,KAAK,GAAA;AAAA;AAAA;AACX;AACA,UAAM,IAAI;AAAA;AAAA,+BAAG,IAAI,IAAJ,EAAH,CAAV;;AAFW;AAAA;AAGX,IAAA,IAAI,CAAC,OAAL,CAAa,IAAI,CAAC,OAAL,KAAiB,CAA9B;;AAHW;AAAA;AAIX,WAAO,KAAK,QAAL,CAAc,SAAd,CAAwB,IAAxB,EAA8B,KAAK,UAAnC,CAAP;AACD;;AAEO,EAAA,gBAAgB,GAAA;AAAA;AAAA;AAAA;AACtB,IAAA,MAAA,CAAA,aAAA,CAAc,KAAK,cAAL,CAAoB,IAAlC,EAAwC,KAAK,cAAL,CAAoB,aAA5D,EAA2E,CAAC,IAAD,EAAa,MAAb,KAAiC;AAAA;AAAA;;;;AAC1G,YAAM,IAAI;AAAA;AAAA,iCAAG,MAAM,CAAC,GAAP,CAAW,MAAX,CAAH,CAAV;;AAD0G;AAAA;AAE1G,WAAK,IAAL,GAAY,IAAI,KAAK,IAAT;AAAA;AAAA,mCAAgB,CAAC,IAAjB;AAAA;AAAA,mCAAwB,CAAxB,CAAZ;AACA,YAAM,IAAI;AAAA;AAAA,iCAAG;AAAA;AAAA,oCAAA,EAAA,GAAC,MAAM,CAAC,GAAP,CAAW,MAAX,CAAD,MAAmB,IAAnB;AAAA;AAAA,mCAAmB,EAAA,KAAA,KAAA,CAAnB;AAAA;AAAA,mCAAmB,EAAnB;AAAA;AAAA,mCAAuB,IAAI,CAAC,aAAD,CAA3B,CAAA,EAA4C,KAA5C,CAAkD,GAAlD,CAAH,CAAV;;AAH0G;AAAA;AAI1G,WAAK,SAAL,GAAiB,IAAI,CAAC,CAAD,CAArB;;AAJ0G;AAAA;AAK1G,WAAK,SAAL,GAAiB,IAAI,CAAC,CAAD,CAAJ,KAAY,KAA7B;;AAL0G;AAAA;;AAM1G,UAAI,MAAM,CAAC,GAAP,CAAW,MAAX,CAAJ,EAAwB;AAAA;AAAA;AAAA;AACtB,aAAK,QAAL,GAAgB,KAAK,QAAL,CAAc,SAAd,CAAwB,MAAM,CAAC,GAAP,CAAW,MAAX,CAAxB,EAA4C,KAAK,UAAjD,CAAhB;AACD,OAFD;AAAA;AAAA;AAAA;AAAA;;AAN0G;;AAS1G,UAAI,MAAM,CAAC,GAAP,CAAW,IAAX,CAAJ,EAAsB;AAAA;AAAA;AAAA;AACpB,aAAK,MAAL,GAAc,KAAK,QAAL,CAAc,SAAd,CAAwB,MAAM,CAAC,GAAP,CAAW,IAAX,CAAxB,EAA0C,KAAK,UAA/C,CAAd;AACD,OAFD;AAAA;AAAA;AAAA;AAAA;;AAT0G;AAY1G,WAAK,QAAL;AACD,KAbD,EAaG,SAbH;AAcD;;AAEO,EAAA,QAAQ,GAAA;AAAA;AAAA;AAAA;AACd,SAAK,aAAL,CACG,KADH,CACS;AACL,MAAA,IAAI,EAAE,KAAK,IAAL,GAAY,CADb;AAEL,MAAA,IAAI,EAAE,KAAK,YAFN;AAGL,MAAA,IAAI,EAAE,KAAK,IAAL,EAHD;AAIL,MAAA,QAAQ,EAAE,KAAK,QAJV;AAKL,MAAA,MAAM,EAAE,KAAK;AALR,KADT,EAQG,SARH,CAQc,GAAD,IAAgC;AAAA;AAAA;AAAA;AAAA,kBAAK,SAAL,CAAe,GAAG,CAAC,IAAnB,EAAyB,GAAG,CAAC,OAA7B;AAAqC,KARlF;AASD;;AAEO,EAAA,IAAI,GAAA;AAAA;AAAA;AACV,UAAM,MAAM;AAAA;AAAA,+BAAG,CAAC,KAAK,SAAL,GAAiB,GAAjB,IAAwB,KAAK,SAAL;AAAA;AAAA,iCAAiB,KAAjB;AAAA;AAAA,iCAAyB,MAAzB,CAAxB,CAAD,CAAH,CAAZ;;AADU;AAAA;;AAEV,QAAI,KAAK,SAAL,KAAmB,IAAvB,EAA6B;AAAA;AAAA;AAAA;AAC3B,MAAA,MAAM,CAAC,IAAP,CAAY,IAAZ;AACD,KAFD;AAAA;AAAA;AAAA;AAAA;;AAFU;AAKV,WAAO,MAAP;AACD;;AAEO,EAAA,SAAS,CAAC,MAAD,EAAyB,OAAzB,EAA6C;AAAA;AAAA;AAAA;AAC5D,SAAK,UAAL,GAAkB,MAAM,CAAC,OAAO,CAAC,GAAR,CAAY,eAAZ,CAAD,CAAxB;;AAD4D;AAAA;AAE5D,SAAK,MAAL;AAAc;AAAA,kCAAA,MAAM;AAAA;AAAA,kCAAI,EAAJ,CAApB;AACD;;AAnGyB,CAA5B;;;;AAAa,eAAe,GAAA,OAAA,CAAA,UAAA,CAAA,CAJ3B,MAAA,CAAA,SAAA,CAAU;AACT,EAAA,QAAQ,EAAE,WADD;AAET,EAAA,QAAA,EAAA,OAAA,CAAa,yBAAb;AAFS,CAAV,CAI2B,E,yCAaD,gBAAA,CAAA,a,EACC,QAAA,CAAA,c,EACN,QAAA,CAAA,Q,EACF,QAAA,CAAA,M,EAhBQ,CAAA,EAAf,eAAe,CAAf;;;;AAAA,OAAA,CAAA,eAAA,GAAA,eAAA","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { HttpResponse, HttpHeaders } from '@angular/common/http';\r\nimport { DatePipe } from '@angular/common';\r\nimport { ActivatedRoute, ParamMap, Router, Data } from '@angular/router';\r\nimport { combineLatest } from 'rxjs';\r\n\r\nimport { ITEMS_PER_PAGE } from 'app/shared/constants/pagination.constants';\r\nimport { Audit } from './audit.model';\r\nimport { AuditsService } from './audits.service';\r\n\r\n@Component({\r\n  selector: 'jhi-audit',\r\n  templateUrl: './audits.component.html',\r\n})\r\nexport class AuditsComponent implements OnInit {\r\n  audits?: Audit[];\r\n  fromDate = '';\r\n  itemsPerPage = ITEMS_PER_PAGE;\r\n  page!: number;\r\n  predicate!: string;\r\n  ascending!: boolean;\r\n  toDate = '';\r\n  totalItems = 0;\r\n\r\n  private dateFormat = 'yyyy-MM-dd';\r\n\r\n  constructor(\r\n    private auditsService: AuditsService,\r\n    private activatedRoute: ActivatedRoute,\r\n    private datePipe: DatePipe,\r\n    private router: Router\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.toDate = this.today();\r\n    this.fromDate = this.previousMonth();\r\n    this.handleNavigation();\r\n  }\r\n\r\n  canLoad(): boolean {\r\n    return this.fromDate !== '' && this.toDate !== '';\r\n  }\r\n\r\n  transition(): void {\r\n    if (this.canLoad()) {\r\n      this.router.navigate(['/admin/audits'], {\r\n        queryParams: {\r\n          page: this.page,\r\n          sort: this.predicate + ',' + (this.ascending ? 'asc' : 'desc'),\r\n          from: this.fromDate,\r\n          to: this.toDate,\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  private previousMonth(): string {\r\n    let date = new Date();\r\n    if (date.getMonth() === 0) {\r\n      date = new Date(date.getFullYear() - 1, 11, date.getDate());\r\n    } else {\r\n      date = new Date(date.getFullYear(), date.getMonth() - 1, date.getDate());\r\n    }\r\n    return this.datePipe.transform(date, this.dateFormat)!;\r\n  }\r\n\r\n  private today(): string {\r\n    // Today + 1 day - needed if the current day must be included\r\n    const date = new Date();\r\n    date.setDate(date.getDate() + 1);\r\n    return this.datePipe.transform(date, this.dateFormat)!;\r\n  }\r\n\r\n  private handleNavigation(): void {\r\n    combineLatest(this.activatedRoute.data, this.activatedRoute.queryParamMap, (data: Data, params: ParamMap) => {\r\n      const page = params.get('page');\r\n      this.page = page !== null ? +page : 1;\r\n      const sort = (params.get('sort') ?? data['defaultSort']).split(',');\r\n      this.predicate = sort[0];\r\n      this.ascending = sort[1] === 'asc';\r\n      if (params.get('from')) {\r\n        this.fromDate = this.datePipe.transform(params.get('from'), this.dateFormat)!;\r\n      }\r\n      if (params.get('to')) {\r\n        this.toDate = this.datePipe.transform(params.get('to'), this.dateFormat)!;\r\n      }\r\n      this.loadData();\r\n    }).subscribe();\r\n  }\r\n\r\n  private loadData(): void {\r\n    this.auditsService\r\n      .query({\r\n        page: this.page - 1,\r\n        size: this.itemsPerPage,\r\n        sort: this.sort(),\r\n        fromDate: this.fromDate,\r\n        toDate: this.toDate,\r\n      })\r\n      .subscribe((res: HttpResponse<Audit[]>) => this.onSuccess(res.body, res.headers));\r\n  }\r\n\r\n  private sort(): string[] {\r\n    const result = [this.predicate + ',' + (this.ascending ? 'asc' : 'desc')];\r\n    if (this.predicate !== 'id') {\r\n      result.push('id');\r\n    }\r\n    return result;\r\n  }\r\n\r\n  private onSuccess(audits: Audit[] | null, headers: HttpHeaders): void {\r\n    this.totalItems = Number(headers.get('X-Total-Count'));\r\n    this.audits = audits || [];\r\n  }\r\n}\r\n"]}